# default/transforms.conf
# Halcyon.ai for Splunk App
# Field normalization and metrics routing

############################
# JSON cleanup
############################
[halcyon_null_cleanup]
REGEX = \\u0000
FORMAT =
DEST_KEY = _raw

############################
# Timestamp handling
############################
[halcyon_created_at]
REGEX = \"createdAt\":\"([^\"]+)\"
FORMAT = _time::$1
WRITE_META = true

[halcyon_last_updated_at]
REGEX = \"lastUpdatedDate\":\"([^\"]+)\"
FORMAT = last_updated_date::$1

[halcyon_completed_at]
REGEX = \"completedAt\":\"([^\"]+)\"
FORMAT = completed_at::$1

############################
# Identity normalization
############################
[halcyon_id]
REGEX = \"id\":\"([a-f0-9\-]{36})\"
FORMAT = halcyon_id::$1

[halcyon_tenant_id]
REGEX = \"tenant(Id|_id)\":\"([a-f0-9\-]{36})\"
FORMAT = tenant_id::$2

[halcyon_subtenant_id]
REGEX = \"subtenant(Id|_id)\":\"([a-f0-9\-]{36})\"
FORMAT = subtenant_id::$2

############################
# Status / severity
############################
[halcyon_status]
REGEX = \"status\":\"([^\"]+)\"
FORMAT = status::$1

[halcyon_severity]
REGEX = \"severity\":\"([^\"]+)\"
FORMAT = severity::$1

############################
# Object typing
############################
[halcyon_object_type]
REGEX = \"objectType\":\"([^\"]+)\"
FORMAT = object_type::$1

############################
# Metrics routing
############################
[halcyon_event_metrics]
REGEX = \"(total|blocked|allowed|sandboxed|total_duplicates|blocked_duplicates|allowed_duplicates|sandboxed_duplicates)\":\s*\d+
DEST_KEY = _meta
FORMAT = index=security_halycon_metrics
