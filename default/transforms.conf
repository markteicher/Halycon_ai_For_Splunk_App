# default/transforms.conf
#
# Halcyon.ai for Splunk App
# JSON field handling, timestamp normalization, and optional lookups

############################
# Common JSON cleanup
############################
[halcyon_json_cleanup]
REGEX = \\u0000
FORMAT = 
DEST_KEY = _raw

############################
# Timestamp normalization
############################
[halcyon_created_at]
REGEX = \"createdAt\":\"([^\"]+)\"
FORMAT = _time::$1
DEST_KEY = _meta

[halcyon_updated_at]
REGEX = \"updatedAt\":\"([^\"]+)\"
FORMAT = updated_at::$1
DEST_KEY = _raw

############################
# ID normalization
############################
[halcyon_id]
REGEX = \"id\":\"([^\"]+)\"
FORMAT = halcyon_id::$1
DEST_KEY = _raw

############################
# Tenant / Subtenant enrichment
############################
[halcyon_tenant_id]
REGEX = \"tenantId\":\"([^\"]+)\"
FORMAT = tenant_id::$1
DEST_KEY = _raw

[halcyon_subtenant_id]
REGEX = \"subtenantId\":\"([^\"]+)\"
FORMAT = subtenant_id::$1
DEST_KEY = _raw

############################
# Severity / Priority normalization
############################
[halcyon_severity]
REGEX = \"severity\":\"([^\"]+)\"
FORMAT = severity::$1
DEST_KEY = _raw

############################
# Status normalization
############################
[halcyon_status]
REGEX = \"status\":\"([^\"]+)\"
FORMAT = status::$1
DEST_KEY = _raw

############################
# Object type tagging
############################
[halcyon_object_type]
REGEX = \"objectType\":\"([^\"]+)\"
FORMAT = object_type::$1
DEST_KEY = _raw

############################
# Auth / Health response tagging
############################
[halcyon_auth_type]
REGEX = \"authType\":\"([^\"]+)\"
FORMAT = auth_type::$1
DEST_KEY = _raw
