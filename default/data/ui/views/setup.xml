<!--
default/data/ui/views/setup.xml
Halcyon.ai for Splunk App â€” Setup
-->

<form version="1.1" theme="light">
  <label>Halcyon.ai for Splunk App â€” Setup</label>
  <description>Configure API access, proxy settings, and data collection.</description>

  <row>
    <panel>
      <html>
        <script src="/static/app/halcyon_for_splunk/setup.js"></script>
      </html>
    </panel>
  </row>

  <fieldset submitButton="true">

    <!-- API CONFIGURATION -->
    <row>
      <panel>
        <title>ğŸ” API Configuration</title>

        <input type="text" token="halcyon_api_base_url">
          <label>API Base URL</label>
          <default>https://api.halcyon.ai</default>
        </input>

        <input type="password" token="halcyon_api_token">
          <label>API Token (Bearer)</label>
        </input>

        <input type="dropdown" token="halcyon_verify_ssl">
          <label>Verify SSL</label>
          <choice value="true">true</choice>
          <choice value="false">false</choice>
          <default>true</default>
        </input>

        <input type="text" token="halcyon_request_timeout">
          <label>Request Timeout (seconds)</label>
          <default>60</default>
        </input>
      </panel>
    </row>

    <!-- PROXY CONFIGURATION -->
    <row>
      <panel>
        <title>ğŸŒ Proxy Configuration</title>

        <input type="dropdown" token="halcyon_use_proxy">
          <label>Use Proxy</label>
          <choice value="false">false</choice>
          <choice value="true">true</choice>
          <default>false</default>
        </input>

        <input type="text" token="halcyon_proxy_url" depends="$halcyon_use_proxy$=true">
          <label>Proxy URL</label>
        </input>

        <input type="text" token="halcyon_proxy_username" depends="$halcyon_use_proxy$=true">
          <label>Proxy Username</label>
        </input>

        <input type="password" token="halcyon_proxy_password" depends="$halcyon_use_proxy$=true">
          <label>Proxy Password</label>
        </input>
      </panel>
    </row>

    <!-- DATA INPUTS -->
    <row>
      <panel>
        <title>ğŸ“¥ Data Inputs</title>

        <input type="checkbox" token="halcyon_inputs">
          <label>Select Inputs</label>

          <!-- Core Security Objects -->
          <choice value="alerts">ğŸ›¡ï¸ Alerts</choice>
          <choice value="alert_instances">ğŸ§© Alert Instances</choice>
          <choice value="events">ğŸ“… Events</choice>
          <choice value="threats">âš ï¸ Threats</choice>
          <choice value="artifacts">ğŸ“¦ Artifacts</choice>

          <!-- Assets & Devices -->
          <choice value="assets">ğŸ–¥ï¸ Assets</choice>
          <choice value="devices">ğŸ“Ÿ Devices</choice>
          <choice value="device_extracted_keys">ğŸ”‘ Device Extracted Keys</choice>

          <!-- Identity & Access -->
          <choice value="tenant_users">ğŸ‘¥ Tenant Users</choice>
          <choice value="identity_providers">ğŸªª Identity Providers</choice>

          <!-- Tenancy & Structure -->
          <choice value="tenants">ğŸ¢ Tenants</choice>
          <choice value="subtenants">ğŸ¬ Subtenants</choice>
          <choice value="deployment_groups">ğŸ§± Deployment Groups</choice>

          <!-- Policy & Control Plane -->
          <choice value="policies">ğŸ“œ Policies</choice>
          <choice value="policy_groups">ğŸ—‚ï¸ Policy Groups</choice>
          <choice value="overrides">ğŸ› ï¸ Overrides</choice>
          <choice value="tags">ğŸ·ï¸ Tags</choice>

          <!-- Operations & Automation -->
          <choice value="jobs">ğŸ§° Jobs</choice>
          <choice value="webhooks">ğŸ”” Webhooks</choice>
          <choice value="integrations">ğŸ”Œ Integrations</choice>
          <choice value="installers">â¬‡ï¸ Installers</choice>

          <!-- Platform Health -->
          <choice value="health">ğŸ’“ Health</choice>
          <choice value="auth_events">ğŸ” Auth Events</choice>

          <default>alerts,events,threats,artifacts,devices,assets,health</default>
        </input>
      </panel>
    </row>

    <!-- COLLECTION SETTINGS -->
    <row>
      <panel>
        <title>â±ï¸ Collection Settings</title>

        <input type="text" token="halcyon_poll_interval_seconds">
          <label>Polling Interval (seconds)</label>
          <default>3600</default>
        </input>

        <input type="text" token="halcyon_lookback_minutes">
          <label>Lookback Window (minutes)</label>
          <default>120</default>
        </input>

        <input type="dropdown" token="halcyon_enable_backfill">
          <label>Enable Backfill</label>
          <choice value="false">false</choice>
          <choice value="true">true</choice>
          <default>false</default>
        </input>
      </panel>
    </row>

  </fieldset>
</form>
