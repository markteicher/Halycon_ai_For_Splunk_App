<!--
default/data/ui/views/halycon_assets.xml
Halcyon.ai for Splunk App â€” Assets
-->

<form version="1.1" theme="light">
  <label>ğŸ–¥ï¸ Assets</label>
  <description>Asset inventory, deployment context, and lifecycle visibility.</description>

  <search>
    <query>
      index=security_halycon sourcetype=halcyon:asset
    </query>
    <earliest>-24h</earliest>
    <latest>now</latest>
  </search>

  <!-- =============================== -->
  <!-- Asset Inventory Table           -->
  <!-- =============================== -->
  <row>
    <panel>
      <title>ğŸ–¥ï¸ Asset Inventory</title>
      <table>
        <search>
          <query>
            index=security_halycon sourcetype=halcyon:asset
            | fields
                asset_id
                asset_name
                tenant_id
                policy_group_name
                policy_group_owner
                deployment_group_name
                macAddresses
                ipAddresses.value
                lastHeartbeatDate
                createdDate
                lastUpdatedDate
                deletedAt
            | eval status_icon=if(isnotnull(deletedAt),"ğŸŸ¥ Deleted","ğŸŸ¢ Active")
          </query>
        </search>

        <option name="count">25</option>
        <option name="wrap">true</option>
        <option name="drilldown">row</option>

        <drilldown>
          <set token="asset_id">$row.asset_id$</set>
        </drilldown>

        <fields>
          <field name="status_icon">Status</field>
          <field name="asset_name">ğŸ–¥ï¸ Asset Name</field>
          <field name="asset_id">ğŸ†” Asset ID</field>
          <field name="policy_group_name">ğŸ“œ Policy Group</field>
          <field name="policy_group_owner">ğŸ‘¤ Policy Owner</field>
          <field name="deployment_group_name">ğŸ§± Deployment Group</field>
          <field name="macAddresses">ğŸ”— MAC Addresses</field>
          <field name="ipAddresses.value">ğŸŒ IP Addresses</field>
          <field name="lastHeartbeatDate">ğŸ’“ Last Heartbeat</field>
          <field name="lastUpdatedDate">ğŸ•’ Last Updated</field>
          <field name="createdDate">ğŸ“… Created</field>
        </fields>
      </table>
    </panel>
  </row>

  <!-- =============================== -->
  <!-- Asset Status Summary             -->
  <!-- =============================== -->
  <row>
    <panel>
      <title>ğŸ“Š Asset Status Overview</title>
      <chart>
        <search>
          <query>
            index=security_halycon sourcetype=halcyon:asset
            | eval status=if(isnotnull(deletedAt),"ğŸŸ¥ Deleted","ğŸŸ¢ Active")
            | stats count by status
          </query>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>
  </row>

</form>
