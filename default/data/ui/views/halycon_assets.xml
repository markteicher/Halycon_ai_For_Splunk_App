<form version="1.1" theme="light">
  <label>ğŸ–¥ï¸ Assets</label>

  <row>
    <panel>
      <table>
        <search>
          <query>
            index=security_halcyon sourcetype=halcyon:asset
            | spath
            | eval status=case(
                isnotnull(deletedAt), "âŒ Deleted",
                isnull(lastHeartbeatDate), "âšª No Heartbeat",
                now() - strptime(lastHeartbeatDate, "%Y-%m-%dT%H:%M:%SZ") &lt;= 86400, "ğŸŸ¢ Active (â‰¤24h)",
                now() - strptime(lastHeartbeatDate, "%Y-%m-%dT%H:%M:%SZ") &lt;= 604800, "ğŸŸ¡ Stale (â‰¤7d)",
                1=1, "ğŸ”´ Inactive (&gt;7d)"
              )
            | eval policy_owner=coalesce('policyGroup.owner',"")
            | eval policy_owner_icon=case(
                policy_owner="System","âš™ï¸ System",
                policy_owner!="","ğŸ‘¤ " . policy_owner,
                1=1,""
              )
            | rename
                id AS "ğŸ†” Asset ID"
                tenantId AS "ğŸ¢ Tenant ID"
                name AS "ğŸ–¥ï¸ Asset Name"
                createdDate AS "ğŸ—“ï¸ Created"
                lastUpdatedDate AS "âœï¸ Updated"
                lastHeartbeatDate AS "ğŸ’“ Last Heartbeat"
                deletedAt AS "ğŸ—‘ï¸ Deleted At"
                status AS "ğŸ§­ Status"
                policyGroup.id AS "ğŸ“œ Policy Group ID"
                policyGroup.name AS "ğŸ“œ Policy Group"
                policy_owner_icon AS "ğŸ‘¤ Policy Owner"
                deploymentGroup.id AS "ğŸ§± Deployment Group ID"
                deploymentGroup.name AS "ğŸ§± Deployment Group"
                macAddresses{} AS "ğŸ§¬ MAC Addresses"
                ipAddresses{}.value AS "ğŸŒ IP Addresses"
                ipAddresses{}.ipAddressType AS "ğŸ“¡ IP Type"
            | fields
                "ğŸ§­ Status"
                "ğŸ–¥ï¸ Asset Name"
                "ğŸ†” Asset ID"
                "ğŸ¢ Tenant ID"
                "ğŸ—“ï¸ Created"
                "âœï¸ Updated"
                "ğŸ’“ Last Heartbeat"
                "ğŸ—‘ï¸ Deleted At"
                "ğŸ“œ Policy Group"
                "ğŸ‘¤ Policy Owner"
                "ğŸ§± Deployment Group"
                "ğŸ§¬ MAC Addresses"
                "ğŸŒ IP Addresses"
                "ğŸ“¡ IP Type"
          </query>
        </search>

        <option name="count">50</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
        <option name="drilldown">row</option>
      </table>
    </panel>
  </row>

</form>
