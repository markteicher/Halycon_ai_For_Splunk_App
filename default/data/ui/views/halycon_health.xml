<!--
default/data/ui/views/halcyon_health.xml

Halcyon.ai for Splunk App â€” Platform Health
-->

<form version="1.1" theme="light">
  <label>ğŸ’“ Platform Health</label>
  <description>API availability, ingestion health, and operational status of Halcyon.ai</description>

  <!-- ================= KPI ROW ================= -->
  <row>
    <panel>
      <single>
        <title>ğŸ’“ Health Events</title>
        <search>
          <query>
            index=security_halcyon sourcetype=halcyon:health
            | stats count
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="rangeColors">["#2ecc71"]</option>
      </single>
    </panel>

    <panel>
      <single>
        <title>â±ï¸ API Errors</title>
        <search>
          <query>
            index=security_halcyon sourcetype=halcyon:health level=error
            | stats count
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="rangeColors">["#e74c3c"]</option>
      </single>
    </panel>

    <panel>
      <single>
        <title>ğŸ“¥ Last Ingest</title>
        <search>
          <query>
            index=security_halcyon sourcetype=halcyon:health
            | stats latest(_time) as lastSeen
            | eval lastSeen=strftime(lastSeen,"%Y-%m-%d %H:%M:%S")
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="rangeColors">["#3498db"]</option>
      </single>
    </panel>
  </row>

  <!-- ================= HEALTH EVENTS ================= -->
  <row>
    <panel>
      <title>ğŸ“‹ Health Events</title>
      <table>
        <search>
          <query>
            index=security_halcyon sourcetype=halcyon:health
            | eval eventTime=strftime(_time,"%Y-%m-%d %H:%M:%S")
            | table eventTime status component message
            | sort -eventTime
          </query>
        </search>
        <option name="count">20</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>

  <!-- ================= ERROR TREND ================= -->
  <row>
    <panel>
      <title>ğŸ“ˆ Health & Error Trend</title>
      <chart>
        <search>
          <query>
            index=security_halcyon sourcetype=halcyon:health
            | timechart span=1h count by status
          </query>
        </search>
        <option name="charting.chart">line</option>
        <option name="legend.placement">right</option>
      </chart>
    </panel>
  </row>

  <!-- ================= INGEST LATENCY ================= -->
  <row>
    <panel>
      <title>â³ Ingestion Latency</title>
      <chart>
        <search>
          <query>
            index=security_halcyon sourcetype=halcyon:health latencyMs=*
            | timechart span=1h avg(latencyMs) as avg_latency_ms
          </query>
        </search>
        <option name="charting.chart">area</option>
        <option name="charting.axisY.title">Milliseconds</option>
      </chart>
    </panel>
  </row>

</form>
