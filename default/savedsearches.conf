# default/savedsearches.conf
# Halcyon.ai for Splunk App
# Combat-ready saved searches and alerts (no commentary)

########################################
# INGESTION & HEALTH
########################################

[Halcyon - Data Ingestion Health]
search = index=security_halcyon sourcetype=halcyon:* 
        | stats count by sourcetype
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
alert.track = 0

[Halcyon - API Collector Errors]
search = index=security_halcyon sourcetype=halcyon:collector_error
        | stats count by collector
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = */15 * * * *
enableSched = 1
alert_type = number
alert_comparator = greater than
alert_threshold = 0
alert.severity = 4
alert.track = 1
action.email = 1

########################################
# ALERTS & THREATS
########################################

[Halcyon - New Alerts]
search = index=security_halcyon sourcetype=halcyon:alert
        | where _time >= relative_time(now(), "-1h")
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */15 * * * *
enableSched = 1
alert.track = 1

[Halcyon - High Severity Threats]
search = index=security_halcyon sourcetype=halcyon:threat severity IN ("High","Critical")
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */1 * * *
enableSched = 1
alert.track = 1

########################################
# RANSOMWARE & DETECTIONS
########################################

[Halcyon - Ransomware Detections]
search = index=security_halcyon sourcetype=halcyon:event category="Ransomware"
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
alert.track = 1

[Halcyon - Detection Spike]
search = index=security_halcyon sourcetype=halcyon:event
        | timechart span=15m count
        | where count > 50
dispatch.earliest_time = -4h
dispatch.latest_time = now
cron_schedule = */15 * * * *
enableSched = 1
alert_type = number
alert_comparator = greater than
alert_threshold = 50
alert.severity = 3
alert.track = 1

########################################
# ASSETS & HOSTS
########################################

[Halcyon - New Assets Discovered]
search = index=security_halcyon sourcetype=halcyon:asset
        | where _time >= relative_time(now(), "-24h")
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */2 * * *
enableSched = 1
alert.track = 1

[Halcyon - Offline Hosts]
search = index=security_halcyon sourcetype=halcyon:device status!="Online"
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */1 * * *
enableSched = 1
alert.track = 1

########################################
# POLICY & CONFIGURATION
########################################

[Halcyon - Policy Changes]
search = index=security_halcyon sourcetype=halcyon:policy
        | where _time >= relative_time(now(), "-24h")
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */4 * * *
enableSched = 1
alert.track = 1

[Halcyon - Overrides Active]
search = index=security_halcyon sourcetype=halcyon:override
dispatch.earliest_time = -24h
dispatch.latest_time = now
cron_schedule = 0 */6 * * *
enableSched = 1
alert.track = 0

########################################
# PLATFORM STATUS
########################################

[Halcyon - Platform Health]
search = index=security_halcyon sourcetype=halcyon:health
        | stats latest(status) as status
dispatch.earliest_time = -1h
dispatch.latest_time = now
cron_schedule = */30 * * * *
enableSched = 1
alert_type = number
alert_comparator = not equal to
alert_threshold = 0
alert.severity = 4
alert.track = 1
